#!/bin/bash
# SPDX-License-Identifier: MIT
# Copyright (c) 2025 Blackcat Informatics¬Æ Inc.
# Commit message validation hook
# Ensures commit messages follow conventional commit format and project standards

set -e

# Get the commit message file
COMMIT_MSG_FILE=$1

# Get the script directory
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Run commit message validation
if [ -f "$PROJECT_ROOT/py-qa/check-quality" ]; then
    if ! "$PROJECT_ROOT/py-qa/check-quality" commit-msg "$COMMIT_MSG_FILE"; then
        echo ""
        echo "‚ùå Commit message quality checks failed!"
        exit 1
    fi
fi

# Check commit message for banned words
echo ""
echo "üö´ Checking commit message for banned words..."
if [ -f "$PROJECT_ROOT/py-qa/check-banned-words" ]; then
    if ! "$PROJECT_ROOT/py-qa/check-banned-words" "$COMMIT_MSG_FILE"; then
        echo ""
        echo "‚ùå Commit aborted due to banned words in message!"
        echo "Please revise your commit message and try again."
        exit 1
    fi
fi

exit 0
